<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UPS Sizing - OMNI</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .calc-section { background: #fff; border: 2px solid #1976d2; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .calc-section h2 { color: #1976d2; margin-top: 0; margin-bottom: 18px; font-size: 1.5em; border-bottom: 2px solid #1976d2; padding-bottom: 10px; }
    .input-row { display: grid; grid-template-columns: 1fr 1fr; gap: 18px; margin-bottom: 18px; }
    .input-row.three { grid-template-columns: 1fr 1fr 1fr; }
    .input-group { display: flex; flex-direction: column; }
    .input-group label { margin-bottom: 6px; font-weight: bold; color: #333; font-size: 0.95em; }
    .input-group input, .input-group select { padding: 8px 12px; border: 1px solid #b7c5dd; font-size: 1em; }
    .result-box { background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%); color: white; padding: 24px; margin-top: 24px; }
    .result-box h3 { margin-top: 0; }
    .result-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin-top: 16px; }
    .result-item { text-align: center; padding: 16px; background: rgba(255,255,255,0.1); border-radius: 4px; }
    .result-label { font-size: 0.9em; opacity: 0.9; margin-bottom: 8px; }
    .result-value { font-size: 1.8em; font-weight: bold; }
    .info-box { background: #e3f0fc; border-left: 4px solid #1976d2; padding: 16px; margin: 16px 0; font-size: 0.95em; }
    .warn-box { background: #fff3e0; border-left: 4px solid #ff9800; padding: 16px; margin: 16px 0; font-size: 0.95em; }
    .calc-button { background: #1976d2; color: white; padding: 12px 32px; border: none; font-size: 1.1em; cursor: pointer; width: 100%; margin-top: 12px; }
    .calc-button:hover { background: #1565c0; }
    @media (max-width: 768px) { .input-row, .input-row.three { grid-template-columns: 1fr; } }
    @media print { .top-tabs, .calc-button { display: none !important; } .result-box { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
  </style>
</head>
<body>
  <div class="top-tabs">
    <a class="tab" href="index.html">Home</a><a class="tab" href="switchboard.html">Switchboard Sizer</a><a class="tab" href="switchroom.html">Switchroom Sizer</a><a class="tab" href="lightingsearch.html">Lighting Search</a>
    <div class="tab has-dropdown active"><span>Power Systems</span><div class="dropdown-content">
      <a href="cablesizing.html">Cable Sizing</a><a href="cableweight.html">Cable Weight</a><a href="maxdemand.html">Maximum Demand</a><a href="diversity.html">Diversity Factors</a><a href="faultlevel.html">Fault Level</a><a href="loopimpedance.html">Loop Impedance</a><a href="discrimination.html">Discrimination Check</a><a href="txsizing.html">Transformer Sizing</a><a href="gensizing.html">Generator Sizing</a><a href="upssizing.html">UPS Sizing</a><a href="pfcsizing.html">PFC Sizing</a><a href="harmonics.html">Harmonics Analysis</a><a href="busbarsizing.html">Busbar Sizing</a><a href="ctsizing.html">CT Sizing</a><a href="earthing.html">Earthing Calculator</a>
    </div></div>
    <div class="tab has-dropdown"><span>Protection</span><div class="dropdown-content"><a href="rcdselect.html">RCD Selector</a><a href="spdsizing.html">SPD Sizing</a><a href="iprating.html">IP/IK Rating Guide</a><a href="conduit.html">Conduit Sizer</a><a href="pvsizing.html">PV Sizing</a></div></div>
    <div class="tab has-dropdown"><span>Lighting & Fire</span><div class="dropdown-content"><a href="luxcalc.html">Lux Calculator</a><a href="luxlevels.html">Lux Levels Reference</a><a href="emergencylighting.html">Emergency Lighting</a><a href="fireinterface.html">Fire Interface Matrix</a><a href="smokecontrol.html">Smoke Control</a><a href="essentialservices.html">Essential Services</a></div></div>
    <div class="tab has-dropdown"><span>Documentation</span><div class="dropdown-content"><a href="loadschedule.html">Load Schedule</a><a href="cableschedule.html">Cable Schedule</a><a href="designcert.html">Design Certificate</a><a href="tcommissioning.html">T&C Checklists</a><a href="inspection.html">Site Inspection</a><a href="sld.html">Single Line Diagram</a><a href="as3000tips.html">AS3000 Tips</a><a href="as3000viewer.html">AS3000 Viewer</a></div></div>
    <a class="tab" href="qa.html">Verification</a>
  </div>
  <div class="main-content">
    <h1>UPS Sizing Calculator</h1>
    <p>Calculate UPS kVA rating and battery capacity per <strong>AS 4044:2019</strong> (UPS systems) and <strong>AS/NZS 3000</strong>.</p>
    <div class="calc-section">
      <h2>Critical Load Data</h2>
      <div class="info-box"><strong>AS 4044:2019:</strong> UPS shall be rated for the total critical load including future growth. Battery autonomy shall meet the operational requirement for safe shutdown or generator transfer.</div>
      <div class="input-row three">
        <div class="input-group"><label for="loadKW">Critical Load (kW)</label><input type="number" id="loadKW" value="50" min="1" step="1" /></div>
        <div class="input-group"><label for="loadPF">Load Power Factor</label><input type="number" id="loadPF" value="0.9" min="0.5" max="1.0" step="0.05" /></div>
        <div class="input-group"><label for="growthPct">Future Growth (%)</label><input type="number" id="growthPct" value="20" min="0" max="100" step="5" /></div>
      </div>
      <div class="input-row three">
        <div class="input-group"><label for="autonomy">Battery Autonomy (minutes)</label>
          <select id="autonomy"><option value="5">5 min (gen backup)</option><option value="10" selected>10 min (standard)</option><option value="15">15 min</option><option value="30">30 min</option><option value="60">60 min</option><option value="120">120 min</option></select>
        </div>
        <div class="input-group"><label for="battType">Battery Technology</label>
          <select id="battType"><option value="vrla" selected>VRLA (sealed lead-acid)</option><option value="lion">Lithium-ion</option><option value="nicd">Nickel-Cadmium</option></select>
        </div>
        <div class="input-group"><label for="redundancy">UPS Configuration</label>
          <select id="redundancy"><option value="1">Single UPS (N)</option><option value="2" selected>Parallel Redundant (N+1)</option><option value="3">2N (fully redundant)</option></select>
        </div>
      </div>
      <div class="input-row three">
        <div class="input-group"><label for="ambTemp">Battery Room Temperature (Ã‚Â°C)</label><input type="number" id="ambTemp" value="25" min="10" max="40" step="1" /></div>
        <div class="input-group"><label for="ageingFactor">Battery Ageing Factor</label><input type="number" id="ageingFactor" value="0.8" min="0.5" max="1.0" step="0.05" /><span style="font-size:0.8em;color:#888;">0.8 typical for end-of-life capacity</span></div>
        <div class="input-group"><label for="rechargeHrs">Target Recharge Time (hours)</label><input type="number" id="rechargeHrs" value="8" min="1" step="1" /></div>
      </div>
      <button class="calc-button" onclick="calculate()">Calculate UPS Size</button>
    </div>
    <div id="resultSection" style="display:none;">
      <div class="result-box">
        <h3>UPS Sizing Results</h3>
        <div class="result-grid">
          <div class="result-item"><div class="result-label">Design Load (kVA)</div><div class="result-value" id="resKVA">Ã¢â‚¬â€</div></div>
          <div class="result-item"><div class="result-label">UPS Module Rating (kVA)</div><div class="result-value" id="resUPS">Ã¢â‚¬â€</div></div>
          <div class="result-item"><div class="result-label">Battery Capacity (Ah @ 480VDC)</div><div class="result-value" id="resAH">Ã¢â‚¬â€</div></div>
          <div class="result-item"><div class="result-label">Number of Battery Strings</div><div class="result-value" id="resStrings">Ã¢â‚¬â€</div></div>
          <div class="result-item"><div class="result-label">Indicative Battery Weight (kg)</div><div class="result-value" id="resWeight">Ã¢â‚¬â€</div></div>
          <div class="result-item"><div class="result-label">Recharge Current (A)</div><div class="result-value" id="resRecharge">Ã¢â‚¬â€</div></div>
        </div>
      </div>
      <div id="notes" class="info-box" style="margin-top:16px;"></div>
    </div>
  </div>
  <script>
    const stdUPS = [10,15,20,30,40,50,60,80,100,120,150,160,200,225,250,300,400,500,600,750,800,1000];
    function calculate() {
      const kw = parseFloat(document.getElementById('loadKW').value);
      const pf = parseFloat(document.getElementById('loadPF').value);
      const growth = parseFloat(document.getElementById('growthPct').value) / 100;
      const mins = parseInt(document.getElementById('autonomy').value);
      const battType = document.getElementById('battType').value;
      const config = parseInt(document.getElementById('redundancy').value);
      const temp = parseFloat(document.getElementById('ambTemp').value);
      const ageing = parseFloat(document.getElementById('ageingFactor').value);
      const rechargeHrs = parseFloat(document.getElementById('rechargeHrs').value);

      const designKW = kw * (1 + growth);
      const designKVA = designKW / pf;

      // UPS module sizing
      let upsKVA;
      if (config === 1) {
        upsKVA = designKVA;
      } else if (config === 2) {
        // N+1: each module = designKVA, need N+1 modules; practical: single module Ã¢â€°Â¥ designKVA
        upsKVA = designKVA;
      } else {
        upsKVA = designKVA; // 2N: two independent UPS each Ã¢â€°Â¥ design
      }
      let selectedUPS = upsKVA;
      for (const s of stdUPS) { if (s >= upsKVA) { selectedUPS = s; break; } }
      if (selectedUPS < upsKVA) selectedUPS = Math.ceil(upsKVA / 50) * 50;

      // Battery sizing
      const dcV = 480; // typical DC bus voltage
      const inverterEff = 0.94;
      const dcPower = designKW / inverterEff; // kW from battery
      const dcCurrent = (dcPower * 1000) / dcV; // A

      // Temperature derating
      let tempFactor = 1.0;
      if (battType === 'vrla') {
        tempFactor = temp > 25 ? 1 - (temp - 25) * 0.005 : 1 + (25 - temp) * 0.005; // approx
        tempFactor = Math.max(0.7, Math.min(1.1, tempFactor));
      }

      // Required Ah = (DC current Ãƒâ€” time in hours) / (ageing Ãƒâ€” temp factor Ãƒâ€” depth of discharge)
      const dod = battType === 'lion' ? 0.85 : 0.80; // depth of discharge
      const hours = mins / 60;
      const requiredAh = (dcCurrent * hours) / (ageing * tempFactor * dod);

      // Strings: each string provides requiredAh at nominal; parallel strings for redundancy
      const stringAh = battType === 'lion' ? 100 : 100; // typical monobloc
      const numStrings = Math.max(1, Math.ceil(requiredAh / stringAh));

      // Weight estimate
      const whPerKg = battType === 'lion' ? 150 : battType === 'vrla' ? 35 : 25;
      const totalWh = requiredAh * dcV;
      const weight = totalWh / whPerKg;

      // Recharge current
      const rechargeCurrent = requiredAh / rechargeHrs * 1.1; // 10% overhead

      document.getElementById('resKVA').textContent = designKVA.toFixed(0);
      document.getElementById('resUPS').textContent = selectedUPS;
      document.getElementById('resAH').textContent = requiredAh.toFixed(0);
      document.getElementById('resStrings').textContent = numStrings;
      document.getElementById('resWeight').textContent = weight.toFixed(0);
      document.getElementById('resRecharge').textContent = rechargeCurrent.toFixed(1);

      const configLabel = {1:'Single (N)', 2:'N+1 Parallel Redundant', 3:'2N Fully Redundant'}[config];
      document.getElementById('notes').innerHTML = `
        <strong>Design Summary:</strong><br>
        Ã¢â‚¬Â¢ Critical load: ${kw} kW + ${(growth*100).toFixed(0)}% growth = ${designKW.toFixed(1)} kW / ${designKVA.toFixed(0)} kVA<br>
        Ã¢â‚¬Â¢ Configuration: ${configLabel} ${config >= 2 ? 'Ã¢â‚¬â€ total installed: ' + (config === 2 ? '2 Ãƒâ€” ' + selectedUPS + ' kVA modules' : '2 Ãƒâ€” ' + selectedUPS + ' kVA independent UPS') : ''}<br>
        Ã¢â‚¬Â¢ Battery: ${battType.toUpperCase()} Ã¢â‚¬â€ ${requiredAh.toFixed(0)} Ah at ${dcV} VDC, ${numStrings} string(s), ${mins} min autonomy<br>
        Ã¢â‚¬Â¢ Estimated battery weight: ${weight.toFixed(0)} kg Ã¢â‚¬â€ verify floor loading capacity<br>
        Ã¢â‚¬Â¢ Recharge time: ${rechargeHrs} hours at ${rechargeCurrent.toFixed(1)} A<br>
        <em>Refer to AS 4044:2019 for detailed UPS installation requirements. Battery room ventilation per AS 2676.</em>
      `;
      document.getElementById('resultSection').style.display = 'block';
    }
  </script>
</body>
</html>
